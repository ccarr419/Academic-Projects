<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CSC552Project2: client.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>client.cpp File Reference</h1>
<p>This file acts as client and prompts the user for input. The prompt will accept either two floating-point numbers or the words 'total' or 'exit'. All input will be written to a pipe to be received by the server. The server will process the information sent and send a message back in response. The client will then display the message from the server and start the prompt again until the user enters 'exit'. All errors dealing with read and write are being accounted for with the use of perror (stderr).  
<a href="#_details">More...</a></p>
<code>#include &lt;iostream&gt;</code><br/>
<code>#include &lt;sstream&gt;</code><br/>
<code>#include &lt;cstdio&gt;</code><br/>
<code>#include &lt;cstdlib&gt;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="client_8cpp.html#ae9849bff2b260ca5e82bea2d7d4c7d14">isSame</a> (string, string)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function takes a two string arguments to compare. It will convert each letter of the first string argument to upper case to ensure case insensitivity. If the string matches the second string then true is returned. If not false is returned. It is assumed that he second argument should be an all caps string and will always return false if it is not.  <a href="#ae9849bff2b260ca5e82bea2d7d4c7d14"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="client_8cpp.html#a1e8a84f803454530da1a4c8d5e1a38b8">pkgNum</a> (string, string)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function takes two string arguments and attempts to package them together into a const char* value so it can be written into a pipe. The output format will be: "number1 *SPACE* number2" This function also assumes that the strings are numeric in nature and does not check the strings for correct format.  <a href="#a1e8a84f803454530da1a4c8d5e1a38b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="client_8cpp.html#aa957124ed9e3e5aba734bd303eaba062">readMessage</a> (int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function takes the file descriptor that should be the read end of a pipe and checks to see if the server wrote anything into the pipe. The message will be printed to the screen if it was properly received. If the message failed to be received an error message will be thrown through perror (stderr) and false will be returned. Otherwise true will be returned. This function assumes that the file descriptor is the read end of a pipe.  <a href="#aa957124ed9e3e5aba734bd303eaba062"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="client_8cpp.html#a5d33ecdcad318e15f6a9a6997d4d4bfa">writeMessage</a> (int, const char *, size_t)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function takes the file descriptor that should be the write end of a pipe and writes the message determined by the 2nd argument to the pipe. The message will be of the size given in the 3rd argument. If the message could not be sent an error message will be thrown through perror (stderr) and false will be returned. Otherwise true will be returned. This function assumes that the file descriptor is the write end of a pipe.  <a href="#a5d33ecdcad318e15f6a9a6997d4d4bfa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="client_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae9849bff2b260ca5e82bea2d7d4c7d14"></a><!-- doxytag: member="client.cpp::isSame" ref="ae9849bff2b260ca5e82bea2d7d4c7d14" args="(string, string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isSame </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>str1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>str2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>* Function Name: isSame Function Type: inspector Parameters: string - import only - string to be modified and compared string - import only - string to be compared to Return Value: bool - true if match, false if no match</p>
<p>isSame will take a two strings as arguments. It will iterate through the first string turning every letter to upper case. Once the string has been converted to all upper case then it will be compared to the second string. If the strings match then the function will return true. If not then false will be returned. This function ensures a case-insensitive comparison. This function also assumes that both strings are numeric and the second string is all upper case. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00143"></a>00143                                       {
<a name="l00144"></a>00144         <span class="comment">//Go to each letter in str1 and make it upper case</span>
<a name="l00145"></a>00145      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; str1.length(); i++)
<a name="l00146"></a>00146           str1[i] = toupper(str1[i]);
<a name="l00147"></a>00147      <span class="keywordflow">if</span>(str1 == str2)
<a name="l00148"></a>00148           <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">//strings match</span>
<a name="l00149"></a>00149      <span class="keywordflow">else</span>
<a name="l00150"></a>00150           <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//strings do not match</span>
<a name="l00151"></a>00151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a><!-- doxytag: member="client.cpp::main" ref="a3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00098"></a>00098                                 {
<a name="l00099"></a>00099         <span class="keywordtype">string</span> TOTAL = <span class="stringliteral">&quot;TOTAL&quot;</span>, EXIT = <span class="stringliteral">&quot;EXIT&quot;</span>;
<a name="l00100"></a>00100         <span class="keywordtype">string</span> n1, n2; <span class="comment">//Numbers (or commands) to be entered in prompt</span>
<a name="l00101"></a>00101         <span class="keywordtype">int</span> fd[2]; <span class="comment">//The pipe the client will be using</span>
<a name="l00102"></a>00102         
<a name="l00103"></a>00103         fd[0] = atoi(argv[0]); <span class="comment">//Convert to int to get the read end of pipe</span>
<a name="l00104"></a>00104         fd[1] = atoi(argv[1]); <span class="comment">//Convert to int to get the write end of pipe</span>
<a name="l00105"></a>00105         
<a name="l00106"></a>00106         <span class="comment">//Display prompt to user once</span>
<a name="l00107"></a>00107         cout &lt;&lt; <span class="stringliteral">&quot;Enter two floating-point numbers &quot;</span>;
<a name="l00108"></a>00108         cout &lt;&lt; <span class="stringliteral">&quot;or the words &apos;TOTAL&apos; or &apos; EXIT&apos;\n&quot;</span>;
<a name="l00109"></a>00109         
<a name="l00110"></a>00110         cout &lt;&lt; <span class="stringliteral">&quot;&gt; &quot;</span>;
<a name="l00111"></a>00111         <span class="comment">//Get only one input string to test if it&apos;s &apos;TOTAL&apos; or &apos;EXIT&apos; first</span>
<a name="l00112"></a>00112         cin &gt;&gt; n1; 
<a name="l00113"></a>00113         
<a name="l00114"></a>00114         <span class="keywordflow">if</span>(<a class="code" href="client_8cpp.html#ae9849bff2b260ca5e82bea2d7d4c7d14" title="This function takes a two string arguments to compare. It will convert each letter...">isSame</a>(n1, <span class="stringliteral">&quot;TOTAL&quot;</span>)) <span class="comment">//User entered &apos;TOTAL&apos; - write total to server</span>
<a name="l00115"></a>00115                 <a class="code" href="client_8cpp.html#a5d33ecdcad318e15f6a9a6997d4d4bfa" title="This function takes the file descriptor that should be the write end of a pipe and...">writeMessage</a>(fd[1], <span class="stringliteral">&quot;TOTAL&quot;</span>, 32);
<a name="l00116"></a>00116                 
<a name="l00117"></a>00117         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="client_8cpp.html#ae9849bff2b260ca5e82bea2d7d4c7d14" title="This function takes a two string arguments to compare. It will convert each letter...">isSame</a>(n1, <span class="stringliteral">&quot;EXIT&quot;</span>)) <span class="comment">//User entered &apos;EXIT&apos; - write exit to server</span>
<a name="l00118"></a>00118                 <a class="code" href="client_8cpp.html#a5d33ecdcad318e15f6a9a6997d4d4bfa" title="This function takes the file descriptor that should be the write end of a pipe and...">writeMessage</a>(fd[1], <span class="stringliteral">&quot;EXIT&quot;</span>, 32);
<a name="l00119"></a>00119         
<a name="l00120"></a>00120         <span class="comment">//If not total or exit then must get another number</span>
<a name="l00121"></a>00121         <span class="keywordflow">else</span> {
<a name="l00122"></a>00122                 cin &gt;&gt; n2; <span class="comment">//Get and package both numbers - write package to server</span>
<a name="l00123"></a>00123                 <a class="code" href="client_8cpp.html#a5d33ecdcad318e15f6a9a6997d4d4bfa" title="This function takes the file descriptor that should be the write end of a pipe and...">writeMessage</a>(fd[1], <a class="code" href="client_8cpp.html#a1e8a84f803454530da1a4c8d5e1a38b8" title="This function takes two string arguments and attempts to package them together into...">pkgNum</a>(n1, n2), BUFSIZ);
<a name="l00124"></a>00124         }
<a name="l00125"></a>00125         
<a name="l00126"></a>00126         sleep(1);       <span class="comment">//Sleep to prevent race conditions</span>
<a name="l00127"></a>00127         <a class="code" href="client_8cpp.html#aa957124ed9e3e5aba734bd303eaba062" title="This function takes the file descriptor that should be the read end of a pipe and...">readMessage</a>(fd[0]+1); <span class="comment">//Get message from server if any</span>
<a name="l00128"></a>00128         
<a name="l00129"></a>00129         <span class="comment">//Close pipe ends since we are done here</span>
<a name="l00130"></a>00130         close(fd[0]+1);
<a name="l00131"></a>00131         close(fd[1]);
<a name="l00132"></a>00132      <span class="keywordflow">return</span> 0;
<a name="l00133"></a>00133 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1e8a84f803454530da1a4c8d5e1a38b8"></a><!-- doxytag: member="client.cpp::pkgNum" ref="a1e8a84f803454530da1a4c8d5e1a38b8" args="(string, string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * pkgNum </td>
          <td>(</td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>num1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>num2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>* Function Name: pkgNum Function Type: facilitator Parameters: string - import only - the first number in the package string - import only - the second number in the package Return Value: const char* - a cstring containing two numbers</p>
<p>pkgNum takes two string arguments and places them inside on const char*. A stringstream is used to make the conversion. The first string is stream inserted into the stringstream followed by a space and the second string argument. The string stream is converted into string and placed inside a temporary holding string. The temporary string is then converted into a cstring and returned. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00160"></a>00160                                              {
<a name="l00161"></a>00161         stringstream str;       
<a name="l00162"></a>00162         str &lt;&lt; num1;
<a name="l00163"></a>00163         str &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00164"></a>00164         str &lt;&lt; num2;
<a name="l00165"></a>00165         <span class="keywordtype">string</span> temp = str.str();
<a name="l00166"></a>00166         <span class="keywordflow">return</span> temp.c_str();
<a name="l00167"></a>00167 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa957124ed9e3e5aba734bd303eaba062"></a><!-- doxytag: member="client.cpp::readMessage" ref="aa957124ed9e3e5aba734bd303eaba062" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool readMessage </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>* Function Name: readMessage Function Type: facilitator Parameters: int - import only -the fdes for the read end of the pipe Return Value: bool - true if message sent, false if not</p>
<p>readMessage takes a single integer argument that represents the file descriptor of the pipe end to read out of. First a message holder of the max size allowed in the system-buffer will be made. Then a message, if one exists will be place inside the message holder. The message will then be printed to the screen. If the message failed to be received then an error message will be printed through perror (stderr) and false will be returned. Otherwise true will be returned. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00177"></a>00177                          {
<a name="l00178"></a>00178         <span class="comment">//Create a static message container of the max size the buffer can hold</span>
<a name="l00179"></a>00179         <span class="keyword">static</span> <span class="keywordtype">char</span> message[BUFSIZ];
<a name="l00180"></a>00180         <span class="comment">//Read from pipe and place it in the message container</span>
<a name="l00181"></a>00181         <span class="keywordflow">if</span>(read(fd, message, BUFSIZ) != -1) {
<a name="l00182"></a>00182                 cout &lt;&lt; message;
<a name="l00183"></a>00183                 fflush(stdout); <span class="comment">//Get everything out of the pipe</span>
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185         <span class="keywordflow">else</span> {
<a name="l00186"></a>00186                 perror(<span class="stringliteral">&quot;Message failed to be received\n&quot;</span>);
<a name="l00187"></a>00187                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00190"></a>00190 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5d33ecdcad318e15f6a9a6997d4d4bfa"></a><!-- doxytag: member="client.cpp::writeMessage" ref="a5d33ecdcad318e15f6a9a6997d4d4bfa" args="(int, const char *, size_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool writeMessage </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>buf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>* Function Name: writeMessage Function Type: facilitator Parameters: int - import only - the fdes for the write end of the pipe const char* - import only - the message to be sent size_t - import only - the size of the message to be sent Return Value: bool - true if message sent, false if not</p>
<p>writeMessage will take three arguments. The first argument is the file descriptor which represents the pipe end the client will write to. The second argument is the message to be written to the pipe. The third is the size of the message to be sent. A message of the size buf will then be constructed and sent to the file descriptor pipe end. If the message was not send then an error message will be printed through perror (stderr) and false will be returned. Otherwise true will be returned. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00200"></a>00200                                                            {
<a name="l00201"></a>00201         <span class="comment">//Write into the pipe to communicate with he server</span>
<a name="l00202"></a>00202         <span class="keywordflow">if</span>(write(fd, message, buf) != -1) 
<a name="l00203"></a>00203                 fflush(stdout); <span class="comment">//Get everything out of the pipe</span>
<a name="l00204"></a>00204                         
<a name="l00205"></a>00205         <span class="keywordflow">else</span> {
<a name="l00206"></a>00206                 perror(<span class="stringliteral">&quot;Message failed to be sent\n&quot;</span>);
<a name="l00207"></a>00207                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00210"></a>00210 }
</pre></div></p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 11 Mar 2017 for CSC552Project2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
